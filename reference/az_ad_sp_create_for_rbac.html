<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a service principal (sp) and configure its access to Azure resources — az_ad_sp_create_for_rbac • AzureAppService</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>

<!-- ugoe -->
<link href="../ugoe_bootswatch.css" rel="stylesheet">


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Create a service principal (sp) and configure its access to Azure resources — az_ad_sp_create_for_rbac" />
<meta property="og:description" content="Prints a secret to the console as a JSON object.
Copy and set as a secret on your GitHub repository for use with the Azure Login Action." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Matomo -->
<script type="text/javascript">
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://matomo.gwdg.de/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '407']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AzureAppService</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/subugoe/AzureAppService/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a service principal (sp) and configure its access to Azure resources</h1>
    <small class="dont-index">Source: <a href='https://github.com/subugoe/AzureAppService/blob/master/R/ad.R'><code>R/ad.R</code></a></small>
    <div class="hidden name"><code>az_ad_sp_create_for_rbac.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Prints a secret to the console as a JSON object.
Copy and set as a secret on your GitHub repository for use with the <a href='https://github.com/Azure/login'>Azure Login Action</a>.</p>
    </div>

    <pre class="usage"><span class='fu'>az_ad_sp_create_for_rbac</span><span class='op'>(</span>
  name <span class='op'>=</span> <span class='fu'><a href='get_ghactions_url.html'>get_ghactions_url</a></span><span class='op'>(</span><span class='op'>)</span>,
  role <span class='op'>=</span> <span class='st'>"Contributor"</span>,
  scopes <span class='op'>=</span> <span class='fu'>scope_down</span><span class='op'>(</span><span class='op'>)</span>,
  years <span class='op'>=</span> <span class='fl'>1</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>scope_down</span><span class='op'>(</span>
  subscription <span class='op'>=</span> <span class='fu'><a href='az_account.html'>az_account_show</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>$</span><span class='va'>id</span>,
  resource_group <span class='op'>=</span> <span class='fu'><a href='az_configure.html'>az_configure_list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>$</span><span class='va'>resource_group</span>,
  provider <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Microsoft.Web"</span>, <span class='st'>"sites"</span>, <span class='fu'><a href='az_configure.html'>az_configure_list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, sep <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>name</th>
      <td><p>A URI to use as the logic name.
It doesn't need to exist.
If not present (<code>NULL</code>), CLI will generate one (<strong>not recommended</strong>).</p>
<p>This is not the app name <em>to which</em> you're giving access, but the "app" which will be doing the accessing (say, a CI service).
The purpose of this name is to document the purpose of the sp.
Default uses the GitHub Actions URL for the repo to indicate that the sp is used inside GitHub Actions.</p></td>
    </tr>
    <tr>
      <th>role</th>
      <td><p>Role of the service principal.
Default value (or if <code>NULL</code>): <code>Contributor</code>.</p></td>
    </tr>
    <tr>
      <th>scopes</th>
      <td><p>Space-separated list of scopes the service principal's role assignment applies to.
If <code>NULL</code> (<strong>not recommended</strong>) sets the root of the current subscription.
Should be as minimal as possible.
Defaults to <code>scope_down()</code>.</p></td>
    </tr>
    <tr>
      <th>years</th>
      <td><p>Number of years for which the credentials will be valid.
Default: 1 year.
Secrets should be rotated more often for extra security.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed on to <code><a href='az_cli_run.html'>az_cli_run</a></code></p><dl>
    <dt><code>cmd</code></dt><dd><p>Command, required, optional, additional, extra parameters, as for <code><a href='http://processx.r-lib.org/reference/run.html'>processx::run()</a></code>
<code>add</code> parameters are reserved for the user to pass down additional arguments to the Azure CLI.
<code>extra</code> parameters are reserved for internal use.</p></dd>
    <dt><code>req</code></dt><dd><p>Command, required, optional, additional, extra parameters, as for <code><a href='http://processx.r-lib.org/reference/run.html'>processx::run()</a></code>
<code>add</code> parameters are reserved for the user to pass down additional arguments to the Azure CLI.
<code>extra</code> parameters are reserved for internal use.</p></dd>
    <dt><code>opt</code></dt><dd><p>Command, required, optional, additional, extra parameters, as for <code><a href='http://processx.r-lib.org/reference/run.html'>processx::run()</a></code>
<code>add</code> parameters are reserved for the user to pass down additional arguments to the Azure CLI.
<code>extra</code> parameters are reserved for internal use.</p></dd>
    <dt><code>add</code></dt><dd><p>Command, required, optional, additional, extra parameters, as for <code><a href='http://processx.r-lib.org/reference/run.html'>processx::run()</a></code>
<code>add</code> parameters are reserved for the user to pass down additional arguments to the Azure CLI.
<code>extra</code> parameters are reserved for internal use.</p></dd>
    <dt><code>echo_cmd</code></dt><dd><p>Whether to print the command to run to the screen.</p></dd>
    <dt><code>echo</code></dt><dd><p>Whether to print the standard output and error
to the screen. Note that the order of the standard output and error
lines are not necessarily correct, as standard output is typically
buffered.</p></dd>
  
</dl></td>
    </tr>
    <tr>
      <th>subscription</th>
      <td><p>Name or ID of the Azure subscription to which costs are billed.
According to an upvoted answer on Stack Overflow, <a href='https://stackoverflow.com/questions/45661109/are-azure-subscription-id-aad-tenant-id-and-aad-app-client-id-considered-secre'>Azure subscription IDs need not be considered a secret or personal identifiable information (PII)</a>.
However, depending your applicable context and policies, you may want to provide this argument as a secret.</p>
<p>To find out which subscriptions you are currently authorised to use, run <code><a href='https://rdrr.io/r/base/print.html'>print(az_account_list())</a></code>.</p></td>
    </tr>
    <tr>
      <th>resource_group</th>
      <td><p>The <a href='https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/manage-resource-groups-portal'>Azure resource group</a> to which the app service should belong.</p></td>
    </tr>
    <tr>
      <th>provider</th>
      <td><p>Specific Azure resource and its name to scope down to (such as a webapp).
Defaults to a web app named via <code><a href='az_configure.html'>az_configure()</a></code>.
Set to <code>NULL</code> to skip (not recommended).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is only necessary if you want an sp to programmatically access Azure resources on your behalf, as for example in a CI context.
If you only want interactive access to Azure resources, use <code><a href='az_login.html'>az_login()</a></code> instead.
You can manage existing sps on portal.azure.com.</p>
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>scope_down</code>: Minimal scopes for a webapp, as recommended by <a href='https://github.com/Azure/login'>Azure Login GitHub Action</a>, as of commit <a href='https://github.com/Azure/login/commit/7e173d1a149e25731edf6857f7e506328c7c1d05'><code>7e173d1</code></a>.
Check back with the source for current security recommendations.
<code>subscription</code> requires an ID, does not work with a name.
Use <code><a href='az_account.html'>az_account_show()</a></code> to substitute an ID for a name as in the default.</p></li>
</ul>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    

<p>The printed secret allows programmatic access to an Azure resource and can be used for malicious purposes.
<strong>Ensure that the printed secret is never disclosed</strong>.
For example, make sure that your console logs aren't disclosed.
For security reasons, this function will only run in an interactive session.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="contents col-md-9">
  <p>Developed by <a href='https://www.maxheld.de'>Maximilian Held</a>, <a href='https://www.sub.uni-goettingen.de/'>Göttingen State and University Library</a>.</p>
  <p>
    <a href="https://www.sub.uni-goettingen.de/en/imprint/data-privacy-statement/">Privacy Statement</a>
    and
    <a href="https://www.sub.uni-goettingen.de/impressum/">Imprint</a>
    apply.
  </p>
</div>

<div class="col-md-3 hidden-xs hidden-sm">
  <p>
    <a href="https://www.sub.uni-goettingen.de/"><img src="https://subugoe.github.io/subugoetheme/sub_wordmark.jpg" height="17"></a>
  </p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: 'f03b793f1845a218d40eb430f1cbda5b',
    indexName: 'subugoe_azureAppService',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


